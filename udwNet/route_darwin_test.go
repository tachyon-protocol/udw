package udwNet

import (
	"github.com/tachyon-protocol/udw/udwTest"
	"net"
	"testing"
)

func TestEncodeRouteAddMsg(ot *testing.T) {
	expectByte := []byte{
		0x84, 0x00,
		0x05,
		0x01,
		0x00, 0x00,
		0x00, 0x00,
		0x03, 0x08, 0x00, 0x00,
		0x07, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x01, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,

		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00,

		0x10,
		0x02,
		0x00, 0x00,
		0x08, 0x08, 0x08, 0x08,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		0x10,
		0x02,
		0x00, 0x00,
		0xac, 0x15, 0x00, 0x01,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		0x08,
		0x00,
		0x00, 0x00,
		0xff, 0xff, 0xff, 0xff,
	}

	_, ipnet, err := net.ParseCIDR("8.8.8.8/32")
	udwTest.Equal(err, nil)
	contentB := encodeRouteAddMsg(*ipnet, net.ParseIP("172.21.0.1"))
	udwTest.Equal(expectByte, contentB)
}
